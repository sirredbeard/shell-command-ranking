#!/bin/bash

# Define the file_extensions array
file_extensions=(
    "JPG"
    "JPEG"
    "PDF"
    "PNG"
    "GIF"
    "ai"
    "bat"
    "bmp"
    "c"
    "cc"
    "cmd"
    "conf"
    "cpp"
    "cs"
    "css"
    "db"
    "doc"
    "docx"
    "gif"
    "gz"
    "h"
    "htm"
    "html"
    "htmx"
    "ico"
    "icns"
    "jar"
    "jpeg"
    "jpg"
    "js"
    "jsx"
    "json"
    "log"
    "md"
    "mp4"
    "npmrc"
    "otf"
    "pack"
    "pdf"
    "php"
    "pl"
    "png"
    "ppt"
    "pptx"
    "proj"
    "ps1"
    "psd"
    "py"
    "qcow"
    "qcow2"
    "rb"
    "tar"
    "tgz"
    "ts"
    "ttf"
    "txt"
    "vue"
    "webm"
    "webp"
    "xmp"
    "xpm"
    "yaml"
    "yml"
    "zst"
    "DS_Store"
    "DS_store"
    "xpm"
    "glif"
    "fd"
    "zip"
    "woff"
    "woff2"
    "dox"
    "plist"
    "bats"
    "go"
    "svg"
    "cu"
    "segment"
    "asc"
    "tab"
    "patch"
    "zsh-theme"
    "glm"
    "sum"
    "j2"
    "lock"
    "dir"
    "scale"
    "tex"
    "sty"
    "rst"
    "eps"
    "bdf"
    "list"
    "vim"
    "wav"
    "csv"
    "macos"
    "toml"
    "gitignore"
    "mod"
    "java"
    "xml"
    "cmake"
    "cfg"
    "wxl"
    "exe"
    "ini"
    "service"
    "vimrc"
    "dev"
    "txt"
    "scala"
    "cron"
    "debian"
    "fedora"
    "nix"
    "xcf"
    "1"
    "wxs"
    "ascii"
    "bst"
    "cls"
    "spec"
    "xz"
    "mk"
    "edn"
    "ebuild"
    "glyph"
    "pnach"
    "bin"
    "dll"
    "netset"
    "deb"
    "install"
    "gitkeep"
    "var"
    "diff"
    "tpl"
    "config"
    "rasi"
    "el"
    "dts"
    "initd"
    "sample"
    "sql"
    "confd"
    "desktop"
    "template"
    "properties"
    "dockerignore"
    "org"
    "desc"
    "profile"
    "mask"
    "npmignore"
    "in"
    "fw"
    "ipset"
)

# Get the directory to search from the command-line argument, or default to "repos"
dir_to_search=${1:-repos}

# Build the find command
find_command="find $dir_to_search -type f \\("
first=true
for ext in "${file_extensions[@]}"; do
    if [ "$first" = true ] ; then
        find_command+=" -name \"*.$ext\""
        first=false
    else
        find_command+=" -o -name \"*.$ext\""
    fi
done
find_command+=" \\) -exec rm -f {} +"

# Execute the find command
echo "Deleting files with unwanted extensions"
eval $find_command

# Delete files with no extensions
echo "Deleting files with no extension"
find $dir_to_search -type f -not -name "*.*" -exec rm -rf {} +

# Delete .git folders
echo "Deleting .git folders"
find $dir_to_search -type d -name ".git" ! -path "*shell-command-ranking/.git*" -exec rm -rf {} +
